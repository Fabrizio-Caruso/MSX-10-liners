0DEFINTA-Z:CLS:M=15:SCREEN1:COLOR14,1,1:O=6207:P=6544:Q=0:H=0:N=32:IFJ>RTHENR=J
1DEFUSR=159:A=USR(0):Y=4:W=111:KEYOFF:DEFFNR(X)=INT(RND(1)*X):J=0:VPOKE8192,49
2VPOKE8218,4:VPOKE8205,113:VPOKE8193,129:FORI=0TO10:FORJ=0TO19:G=O+1+I*64+FNR(N)
3VPOKEG,M:VPOKEG+N,W:NEXT:NEXT:FORI=0TO31:VPOKEO-I,215:VPOKE6880+I,215:NEXT
4LOCATE5,0:?CHR$(W)J"  HI"R"  TI"H:S=STICK(0):IFRND(1)>.9THENVPOKEX,191
5IFSTHENVPOKEP,N:Q=P+(S=7)-(S=3)+N*(S=1)-N*(S=5):IFVPEEK(Q)<>MTHENP=Q
6X=O+33+FNR(608):IFVPEEK(P)=191THENY=8
7H=H+1:IFVPEEK(P)=WTHENJ=J+1:FORI=0TOY:VPOKEO+1+FNR(672),W:NEXT:H=0
8VPOKEP,2:IFVPEEK(X)=MTHENVPOKEX-1,M:VPOKEX+1,M:VPOKEX-N,M:VPOKEX+N,M
9ON-(P<6880ANDP>OANDH<99)GOTO4:FORI=0TOO/2:NEXT:GOTO0