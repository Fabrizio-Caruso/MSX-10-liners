0SCREEN1,2,0:COLOR2,1,4:VPOKE8192,129:B=6144:O=6239:P=6544:M=248:IFJ>RTHENR=J
1VPOKE8223,241:VPOKE8196,177:K=1:CLS:KEYOFF:J=0:D=6880:DEFFNR(X)=INT(RND(1)*X)
2Q=.9:CLS:LOCATE11,1:?"MINES":FORI=0TO31:VPOKEO-I,194:VPOKED+I,194:NEXT
3LOCATE3,0:?9-F"  SCORE"J"  HI"R:IFVPEEK(P)=36THENJ=J+4:F=F+(F>0)
4IFRND(1)>QTHENVPOKEP-4+2*FNR(5)+64*FNR(3)-64,M
5VPOKEP,2:L=JAND3:Y=0:S=ASC(INKEY$+"@"):E=SAND1:IFJ>=K*100THENK=K+1:F=0
6C=S-107+E:IFSGN(C)=CTHENY=1:VPOKEP,M:P=P+C*(31*E+1):J=J+1:Q=Q-.001
7VPOKEG,36:G=6148:IFY=1THENIFL=3THENG=O+1+FNR(640):VPOKEG,4
8IFS=32ANDF<9THENVPOKEP-1,32:VPOKEP+1,32:VPOKEP-32,32:VPOKEP+32,32:F=F+1
9ON-(P<DANDP>OANDVPEEK(P)<>M)GOTO3:?"END":FORI=MTOO:NEXT:F=0:GOTO0